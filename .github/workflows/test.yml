name: CI - Frontend Tests

on:
  # Triggers the workflow on pull request events
  pull_request:
    branches: [ main ]

jobs:
  test:
    # Use the latest Ubuntu runner
    runs-on: ubuntu-latest
    
    strategy:
      # Define the matrix for Node.js versions
      matrix:
        node-version: [18.x, 20.x] # It's good practice to test on multiple LTS versions

    steps:
      # Step 1: Checkout the repository code
      - name: Checkout repository
        uses: actions/checkout@v4
      
      # Step 2: Set up the correct Node.js version
      - name: Use Node.js ${{ matrix.node-version }}
        uses: actions/setup-node@v4
        with:
          node-version: ${{ matrix.node-version }}
          # Caching npm dependencies can speed up subsequent runs
          cache: 'npm' 
          
      # Step 3: Install dependencies
      - name: Install dependencies
        run: npm ci # 'npm ci' is faster and more reliable than 'npm install' in CI environments
        
      # Step 4: Run the tests
      - name: Run tests
        run: npm test -- --ci --reporters=default
        env:
          # Explicitly set CI environment variable
          CI: true
